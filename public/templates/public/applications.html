
<div class="card">
    <div class="card-body">
        <div class="row">
            <form action="" method="get">
                <!-- Hidden Filters Section -->
                <div class="row d-none">
                    <input type="hidden" name="searchaction" value="search">
    
                    <!-- Type -->
                    <div class="col-lg-3 mb-3">
                        <label for="id_apptype" class="form-label fw-bold">Type:</label>
                        <select class="form-select" id="id_apptype" name="apptype">
                            <option value="">All</option>
                            {% for at in app_apptypes %}
                                <option value="{{ at.0 }}" {% if apptype == at.0 %}selected{% endif %}>{{ at.1 }}</option>
                            {% endfor %}
                        </select>
                    </div>
    
                    <!-- Status -->
                    <div class="col-lg-3 mb-3">
                        <label for="id_appstatus" class="form-label fw-bold">Status:</label>
                        <select class="form-select" id="id_appstatus" name="appstatus">
                            <option value="" {% if not appstatus %}selected{% endif %}>All</option>
                            {% for at in app_appstatus %}
                                <option value="{{ at.0 }}" {% if appstatus == at.0 %}selected{% endif %}>{{ at.1 }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
    
                <!-- Keyword and Search Button -->
                <div class="row">
                    <div class="col-lg-9 mb-3">
                        <label for="search_field" class="form-label fw-bold">Keyword:</label>
                        <input id="search_field" type="text" class="form-control" name="q" placeholder="Search..." value="{{ query_string }}">
                    </div>
                    <div class="col-lg-3 mb-3 d-flex align-items-end">
                        <input type="submit" name="search" value="Search" class="btn btn-primary w-100" id="submit-id-save">
                    </div>
                </div>
            </form>
            <br>
        </div>
       
        <hr>
        <div class="row">
            <div class="col-xs-12">
                <table id="application-table" class="table table-striped table-bordered table-condensed">
                    <thead>
                        <tr>
                            <th>Lodgement no.</th>
                            <th>Type</th>
                            <th>Title</th>
                            <th>Applicant</th>
                            <th>Lodged on</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row_obj in items %}
                        <tr>
                            <td>
                                <a href="{% url 'public_application' row_obj.pk action %}">WO-{{ row_obj.pk }}</a>
                            </td>
                            <td>{{ row_obj.get_app_type_display }}</td>
                            <td>{{ row_obj.title }}</td>
                            <td>
                                {% if row_obj.organisation %}
                                    {{ row_obj.organisation }}
                                {% else %}
                                    {{ row_obj.applicant.legal_first_name }} {{ row_obj.applicant.legal_last_name }}
                                {% endif %}
                            </td>
                            <td>{{ row_obj.submit_date|date:"d-M-Y" }}</td>
                            <td>
                                <a href="{% url 'public_application' row_obj.pk action %}" title="View">View</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div> 
    </div>        
    </div>
    <br>


    <script>
        function loadTable() {
            $('#application-table').DataTable({
                searching: false,
                paging: true,
                pageLength: 10,
                order: [[0, 'desc']],
                columnDefs: [
                    { type: 'natural-nohtml', targets: 0 },
                    { type: 'date-dd-mmm-yyyy', targets: 4 },
                    { orderable: false, targets: 5 }
                ]
            });
        }
        
        window.addEventListener('load', loadTable);
        </script>
        

